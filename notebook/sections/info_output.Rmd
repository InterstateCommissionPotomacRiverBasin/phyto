---
title: "info_output_for_user"
author: "Luke Vawter"
date: "November 5, 2018"
output: html_document
---
-

```{r echo=FALSE}
knitr::opts_chunk$set(eval=evaluate, cache=cache.me)
```

this is a modified version of data_aquisition created for use with VA_ODU data. DO NOT USE THIS SECTION if you are pulling data from CEDR.  Use the master branch of phyto2 which uses  data_aquisition instead.

```{r}
project.dir <- rprojroot::find_rstudio_root_file()

dir.create(file.path(project.dir, "data/phytoplankton2/"),
           recursive = TRUE, showWarnings = TRUE)

```


Create `url.root`, which represents the root of the CEDR API. All API calls will start with `url.root`. Additionally, use `Sys.Date()` to find today's date, which will be used in the API query. This makes the following script more dynamic because if this script is run in 2 years, it will then include any data that was added to the CEDR database within those 2 years.
```{r}
url.root <- "http://datahub.chesapeakebay.net/api.JSON"
todays.date <- format(Sys.Date(), "%m-%d-%Y")
```


#### Download Station Vector

Create a vector (`station.vec`) of stations that contain phytoplankton data. The vector will be used to query data from from the CEDR API in subsequent code chunks.
```{r}
station.vec <- file.path(url.root,
                       "LivingResources",
                       "TidalPlankton",
                       "Reported",
                       "1-01-1970",
                       todays.date,
                       "17",
                       "Station") %>% 
  fromJSON() %>% 
  pull(unique(MonitoringLocationId))
```

This is an attempt to replace the CEDR information download with data from the most recent VA excel sheet provided by Mike Malonee:
```{r}
phyto.df <- readxl::read_excel(file.path(project.dir, "data/Va_phyto_count_and_event/data-dev_2013_2016_ODU_Phyto_Reported_Data_05mar18.xlsx"))

phyto.df <- clean_up(phyto.df)
```

```{r}
test_phyto.df <- phyto.df %>%
  filter(station %in% c(
    "tf5.#", "tf4.#", "tf3.#", "ret5.#", "ret4.#", "ret3.#"))
```

